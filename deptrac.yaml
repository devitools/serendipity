deptrac:
  paths:
    - ./src

  exclude_files:
    - '#.*test.*#'

  layers:
    - name: Application
      collectors:
        - type: classLike
          value: ^Serendipity\\Application\\.*

    - name: Domain
      collectors:
        - type: classLike
          value:
            ^Serendipity\\Domain\\.*|\
            ^Constructo\\Core\\.*|\
            ^Constructo\\Support\\.*|\
            ^Constructo\\Type\\.*|\
            ^Constructo\\Factory\\.*

    - name: Hyperf
      collectors:
        - type: classLike
          value: ^Serendipity\\Hyperf\\.*

    - name: Infrastructure
      collectors:
        - type: classLike
          value: ^Serendipity\\Infrastructure\\.*

    - name: Presentation
      collectors:
        - type: classLike
          value: ^Serendipity\\Presentation\\.*

    - name: Testing
      collectors:
        - type: classLike
          value: ^Serendipity\\Testing\\.*

    - name: Contract
      collectors:
        - type: classLike
          value:
            ^Psr\\.*|\
            ^Constructo\\Contract\\.*|\
            ^Hyperf\\Contract\\.*|\
            ^Hyperf\\HttpServer\\Contract\\.*|\
            ^Hyperf\\Validation\\.*|\
            ^Hyperf\\Context\\Context$

    - name: Native
      collectors:
        - type: classLike
          value: ^\w+$|^(DS|Decimal)\\.*$

    - name: Vendor
      collectors:
        - type: classLike
          value:
            ^Google\\.*|\
            ^GuzzleHttp\\.*|\
            ^SleekDB\\.*|\
            ^Visus\\Cuid2\\.*|\
            ^Sentry\\.*|\
            ^Swow\\.*|\
            ^MongoDB\\.*|\
            ^Symfony\\.*|\
            ^Hyperf\\(?!Contract|Validation|Context\\Context).*|\
            ^FastRoute\\.*|\
            ^PHPUnit\\.*

  ruleset:
    Application:
      - Domain
      - Contract
      - Native
    Domain:
      - Contract
      - Native
    Hyperf:
      - Domain
      - Contract
      - Native
      - Infrastructure
      - Testing
      - Presentation
      - Vendor
    Infrastructure:
      - Domain
      - Contract
      - Native
      - Hyperf
      - Vendor
    Presentation:
      - Domain
      - Contract
      - Native
      - Infrastructure
      - Hyperf
    Testing:
      - Domain
      - Contract
      - Native
      - Presentation
      - Hyperf
      - Vendor
